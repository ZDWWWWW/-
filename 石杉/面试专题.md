## 消息队列

### 为什么使用消息队列

解耦 异步 削峰

**解耦**

![image-20200721215233238](面试专题.assets/image-20200721215233238.png)

![image-20200721215731834](面试专题.assets/image-20200721215731834.png)



**异步**

![image-20200721220133894](面试专题.assets/image-20200721220133894.png)



![image-20200721220534876](面试专题.assets/image-20200721220534876.png)



**削峰**

![image-20200721221045720](面试专题.assets/image-20200721221045720.png)

![image-20200721221433899](面试专题.assets/image-20200721221433899.png)



### 使用消息队列产生的问题

**系统可用性降低**

**系统复杂度提高**

**一致性问题**

![image-20200722081905576](面试专题.assets/image-20200722081905576.png)

### 如何保证消息队列高可用

**非分布式架构---RabbitMQ**

对RabbitMQ做**镜像集群**，每台机器保存queue的所有数据

![image-20200722085034359](面试专题.assets/image-20200722085034359.png)